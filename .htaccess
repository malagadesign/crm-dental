<IfModule mod_rewrite.c>
    RewriteEngine On

    # Si ya estamos en public/, no hacer nada (evitar loops)
    RewriteCond %{REQUEST_URI} ^/crm/public/
    RewriteRule ^ - [L]

    # Si el archivo existe en la raíz actual, servirlo directamente
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteRule ^ - [L]

    # Si el directorio existe en la raíz actual, servirlo directamente
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [L]

    # Redirigir archivos estáticos directamente a public/
    # Esto maneja build/, css/, js/, etc. que Laravel genera
    RewriteCond %{REQUEST_URI} ^/crm/(build|css|js|images|fonts|favicon\.ico|robots\.txt)
    RewriteRule ^(build|css|js|images|fonts|favicon\.ico|robots\.txt)(.*)$ public/$1$2 [L]

    # Todo lo demás va a public/index.php (que manejará rutas de Laravel)
    RewriteRule ^ public/index.php [L]
</IfModule>